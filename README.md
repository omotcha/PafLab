# PafLab
abstract framework|toolkit derived from PAFF

***
### 0. project environment

better install R extension for PyCharm

- python: 3.9.13
- babel: 2.9.1
- openbabel: 3.1.1
- spyrmsd: 0.5.2

***
### 1. scoring function CASF power confidence interval calculation and visualization
```angular2html
├── PafLab
    ├── utils
        ├── casf
```
- step1: create a folder for one scoring function, e.g. ecif
- step2: prepare files needed for CI calculation:
     - for scoring power, ```processed_score``` is needed
     - for ranking power, ```spearman_results``` is needed
     - for docking power, ```docking_top1.dat``` is needed
     - All the files can be generated by casf-provided python scripts. Screening power calculation is not provided due to time consumption.
- step3: modify method indicating scoring function name inside casf_{scoring|ranking|docking}_ci.R and run them.
```angular2html
method <- "ecif";
```
respective CI results are saved in ```xxx.results``` file inside the folder you create
- step4: copy the CI results and visualize them in jupyter notebooks 
```angular2html
├── PafLab
    ├── view
        ├── casf
```
e.g. for scoring power, check line8&9 @CI_line()|CI_bar() @scoring_power_view.ipynb
```angular2html
data = add(data, "ECIF", 0.840, 0.807, 0.865)
data = add(data, "RTMScore", 0.467, 0.396, 0.531)
```
you may need to add your calculations to data
- step5: run the cells

***
### 2. RTMScore result normalization

the raw output of RTMScore prediction(ligand id) needs to be normalized
```angular2html
├── PafLab
    ├── utils
        ├── DataFrameIO
            ├── rtm_normalize.py
```
please check the docstring of ```rtm_normalize()```

***
### 3. convert mol2 to sdf using babel inline scripts
```angular2html
├── PafLab
    ├── utils
        ├── molfix
            ├── batchMolFix.py
```
please check the docstring of ```mol2toSDF()```

***
### 4. split a multi-ligand large sdf file into single ones
This is used when conducting RTMScore inference. As size of dataloader of RTMScore is limited for memory issues.
```angular2html
├── PafLab
    ├── utils
        ├── rdkit
            ├── sdf_split.py
```
please check the docstring of ```split_into_single_sdf()```

***
### 5. ligand rmsd calculation
```angular2html
├── PafLab
    ├── utils
        ├── rmsd
            ├── ligrmsd.py
```
used for analyzing redocking-power 

spyrmsd use pybel to read molecules
